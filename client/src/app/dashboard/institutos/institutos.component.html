<!-- Tabla de inicio con todos los datos -->
<main fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutGap="0.5%" fxLayoutAlign="center" *ngIf="!nuevo">
    <div fxFlex="60%" class="filtro">
      <mat-form-field>
        <mat-label>Buscar</mat-label>
        <input matInput (keyup)="applyFilter($event)" placeholder="Ex. ium">
      </mat-form-field>
    </div>
    <div fxFlex="40%" class="botonesPrincipal">
      <button mat-stroked-button class="icono" (click)="crearRegistro() " matTooltip="Nuevo registro" >
      <mat-icon>add_circle</mat-icon>
    </button>
      <input type="image" class="icono" (click)="crearPdf() " src="../../../assets/img/icon/adobe_pdf_32.png" matTooltip="Crear Pdf" *ngIf="selection.selected.length > 0">
      <input type="image" class="icono" (click)="crearXls() " src="../../../assets/img/icon/adobe_pdf_32.png" matTooltip="Crear Xls" *ngIf="selection.selected.length > 0">
    </div>
</main>

<main class="contenedorTabla" *ngIf="!nuevo">
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
    <!--checkbox-->
    <ng-container matColumnDef="select" sticky="true">
      <th mat-header-cell *matHeaderCellDef>
        <mat-checkbox (change)="$event ? masterToggle() : null"
                      [checked]="selection.hasValue() && isAllSelected()"
                      [indeterminate]="selection.hasValue() && !isAllSelected()"
                      [aria-label]="checkboxLabel()">
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row">
        <mat-checkbox (click)="$event.stopPropagation()"
                      (change)="$event ? selection.toggle(row) : null"
                      [checked]="selection.isSelected(row)"
                      [aria-label]="checkboxLabel(row)">
        </mat-checkbox>
      </td>
    </ng-container>

    <!--Columnas-->

    <ng-container matColumnDef="codigoIes" >
      <th mat-header-cell *matHeaderCellDef> Código IES </th>
      <td mat-cell *matCellDef="let element"> {{element.codigoIes}} </td>
    </ng-container>

    <ng-container matColumnDef="razonSocial">
      <th mat-header-cell *matHeaderCellDef> Razón Social </th>
      <td mat-cell *matCellDef="let element"> {{element.razonSocial}} </td>
    </ng-container>

    <ng-container matColumnDef="ruc">
      <th mat-header-cell *matHeaderCellDef> RUC </th>
      <td mat-cell *matCellDef="let element"> {{element.ruc}} </td>
    </ng-container>

    <ng-container matColumnDef="pdfRuc">
      <th mat-header-cell *matHeaderCellDef> PDF RUC </th>
      <td mat-cell *matCellDef="let element">
        <input type="image" (click)="verFile(element.pdfRuc, 'pdf-resolucion')" src="../../../assets/img/icon/adobe_pdf_32.png" >
      </td>
    </ng-container>

    <ng-container matColumnDef="resolucion">
      <th mat-header-cell *matHeaderCellDef> Resolución </th>
      <td mat-cell *matCellDef="let element"> {{element.resolucion}} </td>
    </ng-container>

    <ng-container matColumnDef="pdfResolucion">
      <th mat-header-cell *matHeaderCellDef> PDF Resolución </th>
      <td mat-cell *matCellDef="let element">
        <input type="image" (click)="verFile(element.pdfResolucion, 'pdf-resolucion')" src="../../../assets/img/icon/adobe_pdf_32.png" >
      </td>
    </ng-container>

    <ng-container matColumnDef="categoria">
      <th mat-header-cell *matHeaderCellDef> Categoría </th>
      <td mat-cell *matCellDef="let element"> {{element.categoria}} </td>
    </ng-container>

    <ng-container matColumnDef="logotipo">
      <th mat-header-cell *matHeaderCellDef> Logotipo </th>
      <td mat-cell *matCellDef="let element">
        <img class="logoInstituto" src= "{{url}}ver-archivo/{{element.logotipo}}/imagen-logotipo">
      </td>
    </ng-container>

    <ng-container matColumnDef="createdAt">
      <th mat-header-cell *matHeaderCellDef> Creado el: </th>
      <td mat-cell *matCellDef="let element"> {{element.createdAt | date: 'short'}} </td>
    </ng-container>

    <ng-container matColumnDef="updatedAt">
      <th mat-header-cell *matHeaderCellDef> Modificado el: </th>
      <td mat-cell *matCellDef="let element"> {{element.updatedAt | date: 'short'}} </td>
    </ng-container>

    <ng-container matColumnDef="evento" stickyEnd>
      <th mat-header-cell *matHeaderCellDef> Evento</th>
      <td class="edit" mat-cell *matCellDef="let element; let i = index">
        <button   mat-stroked-button  mat-icon-button color="primary" aria-label="Editar registro" matTooltip="Editar registro" (click)="editar(element.id) ">
          <mat-icon>edit</mat-icon>
        </button>
        <button   mat-stroked-button mat-icon-button color="warn" aria-label="Eliminar registro" matTooltip="Eliminar registro" (click)="eliminar(element.id)">
          <mat-icon>delete_forever</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" class="encabezadoTabla"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" ></tr>

  </table>

</main>
<main class="paginador" *ngIf="!nuevo">
  <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
</main>



<!-- formulario de ingreso o modificación de datos -->

<!-- lado izquierdo  -->

<main *ngIf="nuevo">

  <!-- lado izquierdo  -->


  <mat-tab-group mat-align-tabs="center">
    <mat-tab label="Instituto Datos">
      <form [formGroup]="institutoForm" class="formu" enctype="multipart/form-data">

        <mat-grid-list cols="2" rowHeight="600px">
          <mat-grid-tile class="marcar">
            <div class="controles-container">
              <input type="hidden" formControlName="id">
              <mat-form-field>
                <input formControlName="codigoIes" matInput placeholder="Codigo Ies">
                <mat-error>Este campo es obligatorio</mat-error>
                <mat-error *ngIf="institutoForm.controls['codigoIes'].errors?.minlength">El minimo son 3 caracteres</mat-error>
                <mat-error *ngIf="institutoForm.controls['codigoIes'].errors?.maxlength">El maximo son 8 caracteres</mat-error>
              </mat-form-field>

              <mat-form-field>
                <input formControlName="razonSocial" matInput placeholder="Razon Social">
                <mat-error>Este campo es obligatorio</mat-error>
                <mat-error *ngIf="institutoForm.controls['razonSocial'].errors?.minlength">El minimo son 5 caracteres</mat-error>
                <mat-error *ngIf="institutoForm.controls['razonSocial'].errors?.maxlength">El maximo son 50 caracteres</mat-error>
              </mat-form-field>

              <mat-form-field>
                <input formControlName="ruc" matInput placeholder="Ruc">
                <mat-error >Este campo es obligatorio</mat-error>
                <mat-error *ngIf="institutoForm.controls['ruc'].errors?.minlength">El minimo son 13 caracteres</mat-error>
                <mat-error *ngIf="institutoForm.controls['ruc'].errors?.maxlength">El máximo son 13 caracteres</mat-error>
              </mat-form-field>

              <mat-form-field>
                <input formControlName="resolucion" matInput placeholder="Resolucion">
                <mat-error>Este campo es obligatorio</mat-error>
                <mat-error *ngIf="institutoForm.controls['resolucion'].errors?.minlength">El minimo son 3 caracteres</mat-error>
                <mat-error *ngIf="institutoForm.controls['resolucion'].errors?.maxlength">El maximo son 30 caracteres</mat-error>
              </mat-form-field>

              <mat-form-field>
                  <mat-select formControlName="categoria" placeholder="Categoria">
                    <ng-container *ngFor="let categoria of categorias">
                      <mat-option value="{{categoria.value}}">{{categoria.value}}</mat-option>
                    </ng-container>
                  </mat-select>
                  <mat-error>Este campo es obligatorio</mat-error>
                </mat-form-field>

            </div>
          </mat-grid-tile>


          <mat-grid-tile>
            <div class="controles-container">

              <mat-form-field>

                <ngx-mat-file-input  class="upload-drop-zone" (change)="archivoSeleccionado($event,1)"   placeholder="Suba aqui el pdf Ruc" [accept]="'.pdf'" >
                </ngx-mat-file-input>
                <mat-icon matSuffix>folder</mat-icon>
                <mat-error>Este campo es obligatorio</mat-error>
                <input class="miniaturas" *ngIf="miniaturaPdfRuc" type="image" (click)="verFile(rucArchivo, 'pdf-ruc')" src="../../../assets/img/icon/pdf.svg" >

              </mat-form-field>

              <mat-form-field>

                <ngx-mat-file-input  (change)="archivoSeleccionado($event,2)"  placeholder="Suba aqui el pdf resolucion" [accept]="'.pdf'">
                </ngx-mat-file-input>
                <mat-icon matSuffix>folder</mat-icon>
                <mat-error>Este campo es obligatorio</mat-error>
                <input class="miniaturas" *ngIf="miniaturaPdfResolucion" type="image" (click)="verFile(resolucionArchivo, 'pdf-resolucion')" src="../../../assets/img/icon/pdf.svg" >

              </mat-form-field>

              <mat-form-field>

                <ngx-mat-file-input  (change)="archivoSeleccionado($event,3)"  placeholder="Suba aqui el logotipo de la Institucion" [accept]="'image/*'">
                </ngx-mat-file-input>
                <mat-icon matSuffix>folder</mat-icon>
                <mat-error>Este campo es obligatorio</mat-error>
                <input class="miniaturas" *ngIf="miniaturaLogotipo" type="image" (click)="verFile(logotipoImg, 'imagen-logotipo')" src="../../../assets/img/icon/logo.svg" >

              </mat-form-field>

              <div>
                <mat-form-field>
                  <input  matInput placeholder="Email" >

                </mat-form-field>

                  <mat-icon style="text-align: center;" class="plusEmail"  (click)="agregarEmail()" matTooltip="Nuevo Email" >add_circle</mat-icon>

                <div formArrayName="emails" *ngFor="let email of emails.controls; let i=index" >
                    <div [formGroupName]="i">

                        <div class="form-group-now">
                          <mat-form-field>
                            <label class="col-md-1" [attr.for]="'email' + i">Email</label>

                                <input type="text"[attr.id]="'email'+i" class="form-control" formControlName="email">
                              </mat-form-field>

                              <mat-icon style="text-align: center;" class="plusEmail" (click)="removerEmail(i)" matTooltip="Eliminar Email" >restore_from_trash</mat-icon>

                        </div>

                    </div>
                </div>

                <a mat-raised-button routerLink=".">Continuar</a>

              </div>
            </div>

          </mat-grid-tile>
        </mat-grid-list>


      </form>

    </mat-tab>
    <mat-tab label="Localidad-Telefonos"> </mat-tab>
    <button  [disabled]="institutoForm.invalid" *ngIf="!agregar" (click)="guardarRegistro() " mat-raised-button color="primary">Agregar</button>
    <button  *ngIf="!modificar" (click)="guardarEditar() " mat-raised-button color="primary">Modificar</button>
    <button   (click)="cancelado()" mat-raised-button color="warn">Cancelar</button>

  </mat-tab-group>

 <!--lado derecho
// 1  upload RUC -->


<!--2  upload Resolución -->





<!-- 3  upload Logotipo -->




</main>
